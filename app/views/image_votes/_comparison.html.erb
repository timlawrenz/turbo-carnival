<div class="h-full flex flex-col" data-controller="voting">
  <div class="text-center text-white mb-4 flex-shrink-0">
    <h1 class="text-2xl font-bold mb-2">Vote for the Better Image</h1>
    <p class="text-zinc-400 text-sm">
      ‚Üê / ‚Üí arrows to vote ‚Ä¢ K to kill ‚Ä¢ N to skip
    </p>
    <div class="mt-2">
      <%= link_to "üèÜ View Winners", winners_path, class: "text-yellow-500 hover:text-yellow-400 underline text-sm" %>
    </div>
  </div>

  <div class="flex-1 grid md:grid-cols-2 gap-4 min-h-0">
    <!-- Left Image -->
    <%= form_with url: run_vote_path(@run), method: :post, class: "flex flex-col min-h-0", data: { voting_target: "leftForm" } do |f| %>
      <%= f.hidden_field :winner_id, value: candidate_a.id %>
      <%= f.hidden_field :loser_id, value: candidate_b.id %>
      
      <%= f.button type: "submit", class: "flex-1 bg-zinc-800 rounded-lg overflow-hidden shadow-xl hover:shadow-2xl transition-all hover:scale-[1.02] cursor-pointer flex flex-col min-h-0" do %>
        <div class="px-3 py-2 bg-zinc-800 border-b border-zinc-700 flex-shrink-0">
          <p class="text-white font-semibold text-sm"><%= candidate_a.pipeline_step.name %> (Step <%= candidate_a.pipeline_step.order %>)</p>
        </div>
        <div class="flex-1 bg-zinc-700 flex items-center justify-center min-h-0 p-2">
          <% if candidate_a.image_path.present? %>
            <%= image_tag candidate_image_path(candidate_a), class: "max-w-full max-h-full object-contain" %>
          <% else %>
            <span class="text-zinc-500 text-xl">Image (ID: <%= candidate_a.id %>)</span>
          <% end %>
        </div>
      <% end %>
    <% end %>

    <!-- Right Image -->
    <%= form_with url: run_vote_path(@run), method: :post, class: "flex flex-col min-h-0", data: { voting_target: "rightForm" } do |f| %>
      <%= f.hidden_field :winner_id, value: candidate_b.id %>
      <%= f.hidden_field :loser_id, value: candidate_a.id %>
      
      <%= f.button type: "submit", class: "flex-1 bg-zinc-800 rounded-lg overflow-hidden shadow-xl hover:shadow-2xl transition-all hover:scale-[1.02] cursor-pointer flex flex-col min-h-0" do %>
        <div class="px-3 py-2 bg-zinc-800 border-b border-zinc-700 flex-shrink-0">
          <p class="text-white font-semibold text-sm"><%= candidate_b.pipeline_step.name %> (Step <%= candidate_b.pipeline_step.order %>)</p>
        </div>
        <div class="flex-1 bg-zinc-700 flex items-center justify-center min-h-0 p-2">
          <% if candidate_b.image_path.present? %>
            <%= image_tag candidate_image_path(candidate_b), class: "max-w-full max-h-full object-contain" %>
          <% else %>
            <span class="text-zinc-500 text-xl">Image (ID: <%= candidate_b.id %>)</span>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="flex justify-center gap-4 mt-4 flex-shrink-0">
    <%= button_to "Kill Left Image", run_reject_vote_path(@run, candidate_a), method: :post, class: "px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm", data: { voting_target: "leftKill" } %>
    <%= button_to "Kill Right Image", run_reject_vote_path(@run, candidate_b), method: :post, class: "px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm", data: { voting_target: "rightKill" } %>
  </div>
</div>
